{"ast":null,"code":"import _classCallCheck from \"/Users/yangsirui/Downloads/2Table-web-master/2Table-web/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/yangsirui/Downloads/2Table-web-master/2Table-web/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/yangsirui/Downloads/2Table-web-master/2Table-web/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/yangsirui/Downloads/2Table-web-master/2Table-web/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/yangsirui/Downloads/2Table-web-master/2Table-web/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/yangsirui/Downloads/2Table-web-master/2Table-web/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/yangsirui/Downloads/2Table-web-master/2Table-web/src/components/Reserve.js\";\nimport React from 'react';\nimport Container from 'react-bootstrap/Container';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport Button from 'react-bootstrap/Button';\nimport { API_ROOT } from '../constants';\nimport { message, Form, Input, Icon } from 'antd';\nimport $ from 'jquery';\nimport PickyDateTime from 'react-picky-date-time';\nvar FormItem = Form.Item;\nvar style = {\n  height: '200px',\n  width: '200px',\n  margin: '2rem'\n};\nvar button_style = {\n  margin: '0.5rem',\n  backgroundColor: '#222',\n  color: '#61dafb'\n};\nvar buttonSection = {\n  width: '100%',\n  height: '20%',\n  justifyContent: 'center',\n  alignItems: 'center'\n}; // todo: could refactor to time slot mode. currently use others' frame for time saving. tho it's not straight forward\n\nvar tempTime = [\"9:00 AM\", \"9:30 AM\", \"10:00 AM\", \"10:30AM\", \"11:00AM\", \"11:30AM\", \"12:00PM\", \"12:30PM\", \"1:00PM\", \"1:30PM\", \"2:00PM\", \"3:30PM\"];\nexport var Reserve =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Reserve, _React$Component);\n\n  function Reserve(props) {\n    var _this;\n\n    _classCallCheck(this, Reserve);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Reserve).call(this, props));\n\n    _this.handleUserInput = function (event) {\n      _this.setState({\n        size: event.target.value\n      });\n    };\n\n    _this.state = {\n      userId: _this.pros.userId,\n      id: _this.props.resId,\n      resInfo: {},\n      showPickyDateTime: true,\n      date: new Date().getDate().toString(),\n      month: (new Date().getMonth() + 1).toString(),\n      year: new Date().getFullYear().toString(),\n      hour: new Date().getHours().toString(),\n      minute: '00',\n      second: '00',\n      meridiem: 'PM',\n      size: 5\n    };\n    _this.handleReserve = _this.handleReserve.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(Reserve, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      $.ajax({\n        url: \"\".concat(API_ROOT, \"/searchRes?Id=\").concat(this.state.id),\n        method: 'GET'\n      }).then(function (response) {\n        _this2.setState({\n          resInfo: JSON.parse(response)\n        });\n\n        console.log(JSON.parse(response));\n      }, function (error) {\n        message.error(error.responseText);\n      }).catch(function (error) {\n        console.log(error);\n      });\n    }\n  }, {\n    key: \"onYearPicked\",\n    value: function onYearPicked(res) {\n      var year = res.year;\n      this.setState({\n        year: year\n      });\n    }\n  }, {\n    key: \"onMonthPicked\",\n    value: function onMonthPicked(res) {\n      var month = res.month,\n          year = res.year;\n      this.setState({\n        year: year,\n        month: month\n      });\n    }\n  }, {\n    key: \"onDatePicked\",\n    value: function onDatePicked(res) {\n      var date = res.date,\n          month = res.month,\n          year = res.year;\n      this.setState({\n        year: year,\n        month: month,\n        date: date\n      });\n    }\n  }, {\n    key: \"onResetDate\",\n    value: function onResetDate(res) {\n      var date = res.date,\n          month = res.month,\n          year = res.year;\n      this.setState({\n        year: year,\n        month: month,\n        date: date\n      });\n    }\n  }, {\n    key: \"onResetDefaultDate\",\n    value: function onResetDefaultDate(res) {\n      var date = res.date,\n          month = res.month,\n          year = res.year;\n      this.setState({\n        year: year,\n        month: month,\n        date: date\n      });\n    }\n  }, {\n    key: \"onHourChange\",\n    value: function onHourChange(res) {\n      this.setState({\n        hour: res.value\n      });\n    }\n  }, {\n    key: \"onMeridiemChange\",\n    value: function onMeridiemChange(res) {\n      this.setState({\n        meridiem: res\n      });\n    }\n  }, {\n    key: \"onResetTime\",\n    value: function onResetTime(res) {\n      this.setState({\n        second: res.clockHandSecond.value,\n        minute: res.clockHandMinute.value,\n        hour: res.clockHandHour.value\n      });\n    }\n  }, {\n    key: \"onResetDefaultTime\",\n    value: function onResetDefaultTime(res) {\n      this.setState({\n        second: res.clockHandSecond.value,\n        minute: res.clockHandMinute.value,\n        hour: res.clockHandHour.value\n      });\n    }\n  }, {\n    key: \"onClearTime\",\n    value: function onClearTime(res) {\n      this.setState({\n        second: res.clockHandSecond.value,\n        minute: res.clockHandMinute.value,\n        hour: res.clockHandHour.value\n      });\n    } // just toggle your outter component state to true or false to show or hide <PickyDateTime/>\n\n  }, {\n    key: \"openPickyDateTime\",\n    value: function openPickyDateTime() {\n      this.setState({\n        showPickyDateTime: true\n      });\n    }\n  }, {\n    key: \"onClose\",\n    value: function onClose() {\n      this.setState({\n        showPickyDateTime: false\n      });\n    }\n  }, {\n    key: \"handleReserve\",\n    value: function handleReserve(e) {\n      // 用ajax检查capacity然后reserve餐馆，我直接写了alert测试用\n      var pickTime = new Date(this.state.year, this.state.month, this.state.date, this.state.hour, this.state.minute, this.state.second, 0);\n      console.log('Received values of form: ', state);\n\n      if (!pickTime.isAfter(new Date())) {\n        alert(\"please select time after current time\");\n      } else {\n        var time = \"\".concat(this.state.year, \"-\").concat(this.state.month, \"-\").concat(this.state.date, \" \").concat(this.state.hour, \":\").concat(this.state.minute, \":\").concat(this.state.second);\n        var size = this.state.size;\n        $.ajax({\n          url: \"\".concat(API_ROOT, \"/setReservation\"),\n          method: 'POST',\n          data: JSON.stringify({\n            res_id: this.state.id,\n            user_id: this.state.userId,\n            size: this.state.size,\n            pdatetime: time\n          })\n        }).then(function (response) {\n          alert(\"success!\");\n        }, function (error) {\n          message.error(error.responseText);\n        }).catch(function (error) {\n          console.log(error);\n        });\n      }\n\n      e.preventDefault();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$state = this.state,\n          showPickyDateTime = _this$state.showPickyDateTime,\n          date = _this$state.date,\n          month = _this$state.month,\n          year = _this$state.year,\n          hour = _this$state.hour,\n          meridiem = _this$state.meridiem,\n          minute = _this$state.minute,\n          second = _this$state.second;\n      var resInfo = this.state.resInfo;\n      console.log(this.state);\n      return React.createElement(Container, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 189\n        },\n        __self: this\n      }, React.createElement(Row, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 190\n        },\n        __self: this\n      }, React.createElement(Col, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193\n        },\n        __self: this\n      }, resInfo.restaurant), React.createElement(\"img\", {\n        src: \"https://i.loli.net/2019/04/15/5cb3e0210edb5.jpg\",\n        style: style,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194\n        },\n        __self: this\n      }), React.createElement(\"h5\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195\n        },\n        __self: this\n      }, \"addr:  \", resInfo.address, React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196\n        },\n        __self: this\n      }), \"contact: \", resInfo.phone)), React.createElement(Col, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 198\n        },\n        __self: this\n      }, React.createElement(PickyDateTime, {\n        size: \"xs\",\n        mode: 1,\n        show: showPickyDateTime,\n        locale: \"en-us\",\n        defaultTime: \"\".concat(hour, \":\").concat(minute, \":\").concat(second, \" \").concat(meridiem) // \"HH:MM:SS AM\"\n        ,\n        defaultDate: \"\".concat(month, \"/\").concat(date, \"/\").concat(year) // \"MM/DD/YYYY\"\n        ,\n        onClose: function onClose() {\n          return _this3.setState({\n            showPickyDateTime: false\n          });\n        },\n        onYearPicked: function onYearPicked(res) {\n          return _this3.onYearPicked(res);\n        },\n        onMonthPicked: function onMonthPicked(res) {\n          return _this3.onMonthPicked(res);\n        },\n        onDatePicked: function onDatePicked(res) {\n          return _this3.onDatePicked(res);\n        },\n        onResetDate: function onResetDate(res) {\n          return _this3.onResetDate(res);\n        },\n        onResetDefaultDate: function onResetDefaultDate(res) {\n          return _this3.onResetDefaultDate(res);\n        },\n        onHourChange: function onHourChange(res) {\n          return _this3.onHourChange(res);\n        },\n        onMeridiemChange: function onMeridiemChange(res) {\n          return _this3.onMeridiemChange(res);\n        },\n        onResetTime: function onResetTime(res) {\n          return _this3.onResetTime(res);\n        },\n        onResetDefaultTime: function onResetDefaultTime(res) {\n          return _this3.onResetDefaultTime(res);\n        },\n        onClearTime: function onClearTime(res) {\n          return _this3.onClearTime(res);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      }))), React.createElement(Row, {\n        style: buttonSection,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 221\n        },\n        __self: this\n      }, React.createElement(\"h5\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222\n        },\n        __self: this\n      }, \"party size\"), React.createElement(\"input\", {\n        type: \"text\",\n        onChange: this.handleUserInput,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 223\n        },\n        __self: this\n      }))), React.createElement(Row, {\n        style: buttonSection,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        onClick: this.handleReserve,\n        style: button_style,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 229\n        },\n        __self: this\n      }, \"Confirm\")));\n    }\n  }]);\n\n  return Reserve;\n}(React.Component);\nexport var reserve = Form.create()(Reserve);","map":{"version":3,"sources":["/Users/yangsirui/Downloads/2Table-web-master/2Table-web/src/components/Reserve.js"],"names":["React","Container","Row","Col","Button","API_ROOT","message","Form","Input","Icon","$","PickyDateTime","FormItem","Item","style","height","width","margin","button_style","backgroundColor","color","buttonSection","justifyContent","alignItems","tempTime","Reserve","props","handleUserInput","event","setState","size","target","value","state","userId","pros","id","resId","resInfo","showPickyDateTime","date","Date","getDate","toString","month","getMonth","year","getFullYear","hour","getHours","minute","second","meridiem","handleReserve","bind","ajax","url","method","then","response","JSON","parse","console","log","error","responseText","catch","res","clockHandSecond","clockHandMinute","clockHandHour","e","pickTime","isAfter","alert","time","data","stringify","res_id","user_id","pdatetime","preventDefault","restaurant","address","phone","onYearPicked","onMonthPicked","onDatePicked","onResetDate","onResetDefaultDate","onHourChange","onMeridiemChange","onResetTime","onResetDefaultTime","onClearTime","Component","reserve","create"],"mappings":"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","sourcesContent":["import React from 'react';\nimport Container from 'react-bootstrap/Container'\nimport Row from 'react-bootstrap/Row'\nimport Col from 'react-bootstrap/Col'\nimport Button from 'react-bootstrap/Button'\nimport { API_ROOT } from '../constants';\nimport { message, Form ,Input, Icon} from 'antd';\nimport $ from 'jquery';\nimport PickyDateTime from 'react-picky-date-time';\n\nconst FormItem = Form.Item;\n\nconst style = {\n    height: '200px',\n    width: '200px',\n    margin: '2rem'\n};\n\nconst button_style = {\n    margin: '0.5rem',\n    backgroundColor: '#222',\n    color: '#61dafb',\n};\n  \nconst buttonSection = {\n     width: '100%',\n     height: '20%',\n     justifyContent: 'center',\n     alignItems: 'center'\n};\n\n// todo: could refactor to time slot mode. currently use others' frame for time saving. tho it's not straight forward\nvar tempTime = [\"9:00 AM\", \"9:30 AM\", \"10:00 AM\", \"10:30AM\", \"11:00AM\", \"11:30AM\", \"12:00PM\", \"12:30PM\", \"1:00PM\",\n                \"1:30PM\", \"2:00PM\", \"3:30PM\"]\n\nexport class Reserve extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n        userId: this.pros.userId,\n        id: this.props.resId,\n        resInfo: {},\n        showPickyDateTime: true,\n        date: new Date().getDate().toString(),\n        month: (new Date().getMonth() + 1).toString(),\n        year: (new Date().getFullYear()).toString(),\n        hour: (new Date().getHours()).toString(),\n        minute: '00',\n        second: '00',\n        meridiem: 'PM',\n        size: 5,\n    }\n    this.handleReserve = this.handleReserve.bind(this);\n  }\n\n handleUserInput= event => {\n    this.setState({\n      size: event.target.value\n    });\n  }\n\n  componentDidMount() {\n    $.ajax({\n            url: `${API_ROOT}/searchRes?Id=${this.state.id}`,\n            method: 'GET',\n            }).then((response) => {\n                this.setState({\n                    resInfo : JSON.parse(response)\n                });\n                  console.log(JSON.parse(response));\n            },(error) => {\n                    message.error(error.responseText);\n            }).catch((error) => {\n                    console.log(error);\n            });\n  }\n\n  onYearPicked(res) {\n      const { year } = res;\n      this.setState({ year: year});\n    }\n\n    onMonthPicked(res) {\n      const { month, year } = res;\n      this.setState({ year: year, month: month});\n    }\n\n    onDatePicked(res) {\n      const { date, month, year } = res;\n      this.setState({ year: year, month: month, date: date });\n    }\n\n    onResetDate(res) {\n      const { date, month, year } = res;\n      this.setState({ year: year, month: month, date: date });\n    }\n\n    onResetDefaultDate(res) {\n      const { date, month, year } = res;\n      this.setState({ year: year, month: month, date: date });\n    }\n\n    onHourChange(res) {\n      this.setState({ hour: res.value });\n    }\n\n    onMeridiemChange(res) {\n      this.setState({ meridiem: res });\n    }\n\n    onResetTime(res) {\n      this.setState({\n        second: res.clockHandSecond.value,\n        minute: res.clockHandMinute.value,\n        hour: res.clockHandHour.value\n      });\n    }\n\n    onResetDefaultTime(res) {\n      this.setState({\n        second: res.clockHandSecond.value,\n        minute: res.clockHandMinute.value,\n        hour: res.clockHandHour.value\n      });\n    }\n\n    onClearTime(res) {\n      this.setState({\n        second: res.clockHandSecond.value,\n        minute: res.clockHandMinute.value,\n        hour: res.clockHandHour.value\n      });\n    }\n\n    // just toggle your outter component state to true or false to show or hide <PickyDateTime/>\n    openPickyDateTime() {\n      this.setState({showPickyDateTime: true});\n    }\n\n    onClose() {\n      this.setState({showPickyDateTime: false});\n    }\n\n\n  handleReserve(e) {\n      // 用ajax检查capacity然后reserve餐馆，我直接写了alert测试用\n    var pickTime = new Date(this.state.year, this.state.month, this.state.date, this.state.hour, this.state.minute, this.state.second, 0);\n    console.log('Received values of form: ', state);\n    if (!pickTime.isAfter(new Date())){\n         alert(\"please select time after current time\")\n    }else {\n        const time = `${this.state.year}-${this.state.month}-${this.state.date} ${this.state.hour}:${this.state.minute}:${this.state.second}`\n        const size = this.state.size;\n        $.ajax({\n            url: `${API_ROOT}/setReservation`,\n                method: 'POST',\n                data: JSON.stringify({\n                    res_id: this.state.id,\n                    user_id: this.state.userId,\n                    size: this.state.size,\n                    pdatetime: time,\n                }),\n        }).then((response) => {\n            alert(\"success!\");\n        },(error) => {\n            message.error(error.responseText);\n        }).catch((error) => {\n            console.log(error);\n        });\n    }\n\n    e.preventDefault();\n  }\n\n  render() {\n      const {\n        showPickyDateTime,\n        date,\n        month,\n        year,\n        hour,\n        meridiem,\n        minute,\n        second\n      } = this.state;\n      const resInfo = this.state.resInfo;\n      console.log(this.state);\n    return (\n        <Container>\n            <Row>\n                <Col>\n                {/* Col 1 for the Name and Picture of the Restaurant<br /> */}\n                    <h1>{resInfo.restaurant}</h1>\n                    <img src=\"https://i.loli.net/2019/04/15/5cb3e0210edb5.jpg\" style={style} />\n                    <h5>addr:  {resInfo.address}\n                    <br/>contact: {resInfo.phone}</h5>\n                    </Col>\n                <Col>\n                        <PickyDateTime\n                          size=\"xs\"\n                          mode={1}\n                          show={showPickyDateTime}\n                          locale=\"en-us\"\n                          defaultTime={`${hour}:${minute}:${second} ${meridiem}`} // \"HH:MM:SS AM\"\n                          defaultDate={`${month}/${date}/${year}`} // \"MM/DD/YYYY\"\n                          onClose={() => this.setState({ showPickyDateTime: false })}\n                          onYearPicked={res => this.onYearPicked(res)}\n                          onMonthPicked={res => this.onMonthPicked(res)}\n                          onDatePicked={res => this.onDatePicked(res)}\n                          onResetDate={res => this.onResetDate(res)}\n                          onResetDefaultDate={res => this.onResetDefaultDate(res)}\n                          onHourChange={res => this.onHourChange(res)}\n                          onMeridiemChange={res => this.onMeridiemChange(res)}\n                          onResetTime={res => this.onResetTime(res)}\n                          onResetDefaultTime={res => this.onResetDefaultTime(res)}\n                          onClearTime={res => this.onClearTime(res)}\n                        />\n                </Col>\n            </Row>\n            <Row style = {buttonSection}>\n                <div>\n                    <h5>party size</h5>\n                        <input type=\"text\"\n                        onChange={this.handleUserInput}\n                         />\n                </div>\n            </Row>\n            <Row style = {buttonSection}>\n                <button onClick={this.handleReserve} style={button_style}>\n                    Confirm\n                </button>\n            </Row>\n        </Container>\n    );\n  }\n}\nexport const reserve = Form.create()(Reserve);"]},"metadata":{},"sourceType":"module"}